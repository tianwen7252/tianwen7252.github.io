import{r as a,I as ke,_ as re,a as Oe,u as le,b as De,c as ce,d as Y,K as J,g as Ee,m as Me,e as x,f as xe,h as Te,T as ze,C as Pe,D as He,i as Ne,W as Re,R as Ae,A as qe,j as W,l as j,O as Z,k as ee,n as Le,o as b,p as d,q as _e,S as ne,B,s as je,F as I,t as Ke,v as ae,w as te,x as Fe,y as We,z as Be,E as Ve,G as Xe,H as V,J as ie,L as Ge,M as Ue,N as Qe,P as Ye,Q as Je,U as Ze,V as en}from"./index-BiHjvXSo.js";import{S as nn}from"./StickyHeader-DdqQ8MUS.js";import{T as X,P as an}from"./Pagination-DDEvTFMY.js";import{D as tn}from"./index-DLTeWKYP.js";var rn={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M688 312v-48c0-4.4-3.6-8-8-8H296c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h384c4.4 0 8-3.6 8-8zm-392 88c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h184c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8H296zm144 452H208V148h560v344c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8V108c0-17.7-14.3-32-32-32H168c-17.7 0-32 14.3-32 32v784c0 17.7 14.3 32 32 32h272c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm445.7 51.5l-93.3-93.3C814.7 780.7 828 743.9 828 704c0-97.2-78.8-176-176-176s-176 78.8-176 176 78.8 176 176 176c35.8 0 69-10.7 96.8-29l94.7 94.7c1.6 1.6 3.6 2.3 5.6 2.3s4.1-.8 5.6-2.3l31-31a7.9 7.9 0 000-11.2zM652 816c-61.9 0-112-50.1-112-112s50.1-112 112-112 112 50.1 112 112-50.1 112-112 112z"}}]},name:"file-search",theme:"outlined"},ln=function(n,l){return a.createElement(ke,re({},n,{ref:l,icon:rn}))},cn=a.forwardRef(ln),sn=["prefixCls","className","checked","defaultChecked","disabled","loadingIcon","checkedChildren","unCheckedChildren","onClick","onChange","onKeyDown"],se=a.forwardRef(function(e,n){var l,i=e.prefixCls,c=i===void 0?"rc-switch":i,u=e.className,h=e.checked,r=e.defaultChecked,t=e.disabled,o=e.loadingIcon,m=e.checkedChildren,p=e.unCheckedChildren,k=e.onClick,$=e.onChange,O=e.onKeyDown,H=Oe(e,sn),N=le(!1,{value:h,defaultValue:r}),z=De(N,2),y=z[0],w=z[1];function D(C,T){var M=y;return t||(M=C,w(M),$==null||$(M,T)),M}function P(C){C.which===J.LEFT?D(!1,C):C.which===J.RIGHT&&D(!0,C),O==null||O(C)}function S(C){var T=D(!y,C);k==null||k(T,C)}var E=ce(c,u,(l={},Y(l,"".concat(c,"-checked"),y),Y(l,"".concat(c,"-disabled"),t),l));return a.createElement("button",re({},H,{type:"button",role:"switch","aria-checked":y,disabled:t,className:E,ref:n,onKeyDown:P,onClick:S}),o,a.createElement("span",{className:"".concat(c,"-inner")},a.createElement("span",{className:"".concat(c,"-inner-checked")},m),a.createElement("span",{className:"".concat(c,"-inner-unchecked")},p)))});se.displayName="Switch";const on=e=>{const{componentCls:n,trackHeightSM:l,trackPadding:i,trackMinWidthSM:c,innerMinMarginSM:u,innerMaxMarginSM:h,handleSizeSM:r,calc:t}=e,o=`${n}-inner`,m=x(t(r).add(t(i).mul(2)).equal()),p=x(t(h).mul(2).equal());return{[n]:{[`&${n}-small`]:{minWidth:c,height:l,lineHeight:x(l),[`${n}-inner`]:{paddingInlineStart:h,paddingInlineEnd:u,[`${o}-checked, ${o}-unchecked`]:{minHeight:l},[`${o}-checked`]:{marginInlineStart:`calc(-100% + ${m} - ${p})`,marginInlineEnd:`calc(100% - ${m} + ${p})`},[`${o}-unchecked`]:{marginTop:t(l).mul(-1).equal(),marginInlineStart:0,marginInlineEnd:0}},[`${n}-handle`]:{width:r,height:r},[`${n}-loading-icon`]:{top:t(t(r).sub(e.switchLoadingIconSize)).div(2).equal(),fontSize:e.switchLoadingIconSize},[`&${n}-checked`]:{[`${n}-inner`]:{paddingInlineStart:u,paddingInlineEnd:h,[`${o}-checked`]:{marginInlineStart:0,marginInlineEnd:0},[`${o}-unchecked`]:{marginInlineStart:`calc(100% - ${m} + ${p})`,marginInlineEnd:`calc(-100% + ${m} - ${p})`}},[`${n}-handle`]:{insetInlineStart:`calc(100% - ${x(t(r).add(i).equal())})`}},[`&:not(${n}-disabled):active`]:{[`&:not(${n}-checked) ${o}`]:{[`${o}-unchecked`]:{marginInlineStart:t(e.marginXXS).div(2).equal(),marginInlineEnd:t(e.marginXXS).mul(-1).div(2).equal()}},[`&${n}-checked ${o}`]:{[`${o}-checked`]:{marginInlineStart:t(e.marginXXS).mul(-1).div(2).equal(),marginInlineEnd:t(e.marginXXS).div(2).equal()}}}}}}},dn=e=>{const{componentCls:n,handleSize:l,calc:i}=e;return{[n]:{[`${n}-loading-icon${e.iconCls}`]:{position:"relative",top:i(i(l).sub(e.fontSize)).div(2).equal(),color:e.switchLoadingIconColor,verticalAlign:"top"},[`&${n}-checked ${n}-loading-icon`]:{color:e.switchColor}}}},un=e=>{const{componentCls:n,trackPadding:l,handleBg:i,handleShadow:c,handleSize:u,calc:h}=e,r=`${n}-handle`;return{[n]:{[r]:{position:"absolute",top:l,insetInlineStart:l,width:u,height:u,transition:`all ${e.switchDuration} ease-in-out`,"&::before":{position:"absolute",top:0,insetInlineEnd:0,bottom:0,insetInlineStart:0,backgroundColor:i,borderRadius:h(u).div(2).equal(),boxShadow:c,transition:`all ${e.switchDuration} ease-in-out`,content:'""'}},[`&${n}-checked ${r}`]:{insetInlineStart:`calc(100% - ${x(h(u).add(l).equal())})`},[`&:not(${n}-disabled):active`]:{[`${r}::before`]:{insetInlineEnd:e.switchHandleActiveInset,insetInlineStart:0},[`&${n}-checked ${r}::before`]:{insetInlineEnd:0,insetInlineStart:e.switchHandleActiveInset}}}}},hn=e=>{const{componentCls:n,trackHeight:l,trackPadding:i,innerMinMargin:c,innerMaxMargin:u,handleSize:h,calc:r}=e,t=`${n}-inner`,o=x(r(h).add(r(i).mul(2)).equal()),m=x(r(u).mul(2).equal());return{[n]:{[t]:{display:"block",overflow:"hidden",borderRadius:100,height:"100%",paddingInlineStart:u,paddingInlineEnd:c,transition:`padding-inline-start ${e.switchDuration} ease-in-out, padding-inline-end ${e.switchDuration} ease-in-out`,[`${t}-checked, ${t}-unchecked`]:{display:"block",color:e.colorTextLightSolid,fontSize:e.fontSizeSM,transition:`margin-inline-start ${e.switchDuration} ease-in-out, margin-inline-end ${e.switchDuration} ease-in-out`,pointerEvents:"none",minHeight:l},[`${t}-checked`]:{marginInlineStart:`calc(-100% + ${o} - ${m})`,marginInlineEnd:`calc(100% - ${o} + ${m})`},[`${t}-unchecked`]:{marginTop:r(l).mul(-1).equal(),marginInlineStart:0,marginInlineEnd:0}},[`&${n}-checked ${t}`]:{paddingInlineStart:c,paddingInlineEnd:u,[`${t}-checked`]:{marginInlineStart:0,marginInlineEnd:0},[`${t}-unchecked`]:{marginInlineStart:`calc(100% - ${o} + ${m})`,marginInlineEnd:`calc(-100% + ${o} - ${m})`}},[`&:not(${n}-disabled):active`]:{[`&:not(${n}-checked) ${t}`]:{[`${t}-unchecked`]:{marginInlineStart:r(i).mul(2).equal(),marginInlineEnd:r(i).mul(-1).mul(2).equal()}},[`&${n}-checked ${t}`]:{[`${t}-checked`]:{marginInlineStart:r(i).mul(-1).mul(2).equal(),marginInlineEnd:r(i).mul(2).equal()}}}}}},gn=e=>{const{componentCls:n,trackHeight:l,trackMinWidth:i}=e;return{[n]:Object.assign(Object.assign(Object.assign(Object.assign({},xe(e)),{position:"relative",display:"inline-block",boxSizing:"border-box",minWidth:i,height:l,lineHeight:x(l),verticalAlign:"middle",background:e.colorTextQuaternary,border:"0",borderRadius:100,cursor:"pointer",transition:`all ${e.motionDurationMid}`,userSelect:"none",[`&:hover:not(${n}-disabled)`]:{background:e.colorTextTertiary}}),Te(e)),{[`&${n}-checked`]:{background:e.switchColor,[`&:hover:not(${n}-disabled)`]:{background:e.colorPrimaryHover}},[`&${n}-loading, &${n}-disabled`]:{cursor:"not-allowed",opacity:e.switchDisabledOpacity,"*":{boxShadow:"none",cursor:"not-allowed"}},[`&${n}-rtl`]:{direction:"rtl"}})}},mn=e=>{const{fontSize:n,lineHeight:l,controlHeight:i,colorWhite:c}=e,u=n*l,h=i/2,r=2,t=u-r*2,o=h-r*2;return{trackHeight:u,trackHeightSM:h,trackMinWidth:t*2+r*4,trackMinWidthSM:o*2+r*2,trackPadding:r,handleBg:c,handleSize:t,handleSizeSM:o,handleShadow:`0 2px 4px 0 ${new ze("#00230b").setAlpha(.2).toRgbString()}`,innerMinMargin:t/2,innerMaxMargin:t+r+r*2,innerMinMarginSM:o/2,innerMaxMarginSM:o+r+r*2}},Sn=Ee("Switch",e=>{const n=Me(e,{switchDuration:e.motionDurationMid,switchColor:e.colorPrimary,switchDisabledOpacity:e.opacityLoading,switchLoadingIconSize:e.calc(e.fontSizeIcon).mul(.75).equal(),switchLoadingIconColor:`rgba(0, 0, 0, ${e.opacityLoading})`,switchHandleActiveInset:"-30%"});return[gn(n),hn(n),un(n),dn(n),on(n)]},mn);var Cn=function(e,n){var l={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&n.indexOf(i)<0&&(l[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,i=Object.getOwnPropertySymbols(e);c<i.length;c++)n.indexOf(i[c])<0&&Object.prototype.propertyIsEnumerable.call(e,i[c])&&(l[i[c]]=e[i[c]]);return l};const pn=a.forwardRef((e,n)=>{const{prefixCls:l,size:i,disabled:c,loading:u,className:h,rootClassName:r,style:t,checked:o,value:m,defaultChecked:p,defaultValue:k,onChange:$}=e,O=Cn(e,["prefixCls","size","disabled","loading","className","rootClassName","style","checked","value","defaultChecked","defaultValue","onChange"]),[H,N]=le(!1,{value:o??m,defaultValue:p??k}),{getPrefixCls:z,direction:y,switch:w}=a.useContext(Pe),D=a.useContext(He),P=(c??D)||u,S=z("switch",l),E=a.createElement("div",{className:`${S}-handle`},u&&a.createElement(Ae,{className:`${S}-loading-icon`})),[C,T,M]=Sn(S),R=Ne(i),A=ce(w==null?void 0:w.className,{[`${S}-small`]:R==="small",[`${S}-loading`]:u,[`${S}-rtl`]:y==="rtl"},h,r,T,M),K=Object.assign(Object.assign({},w==null?void 0:w.style),t),F=function(){N(arguments.length<=0?void 0:arguments[0]),$==null||$.apply(void 0,arguments)};return C(a.createElement(Re,{component:"Switch"},a.createElement(se,Object.assign({},O,{checked:H,onChange:F,prefixCls:S,className:A,style:K,disabled:P,ref:n,loadingIcon:E}))))}),oe=pn;oe.__ANT_SWITCH=!0;const{RangePicker:fn}=tn,bn=()=>{const[e,n]=a.useState(),[l,i]=a.useState([]),[c,u]=a.useState(0),[h,r]=a.useState(0),[t,o]=a.useState(0),[m,p]=a.useState(!1),[k,$]=a.useState(!1),[O,H]=a.useState(!1),[N,z]=a.useState(!0),[y,w]=a.useState(0),[D,P]=a.useState(""),{appEvent:S}=a.useContext(qe),E=!(e!=null&&e.length),C=a.useMemo(()=>{const s=W.tz(),g=s.startOf("day"),f=s.endOf("day"),v=g.add(-1,"d");return[{label:"今天",value:[g,f]},{label:"昨天",value:[v,v.endOf("day")]},{label:"2天內",value:[v,f]},{label:"7天前",value:[g.add(-7,"d"),f]},{label:"14天內",value:[g.add(-14,"d"),f]},{label:"1個月內",value:[g.add(-30,"d"),f]}]},[]),T=a.useCallback(()=>{p(!0)},[]),M=a.useCallback(()=>{p(!1)},[]),R=a.useCallback(()=>{document.body.classList.add("resta--hidden-scroll"),$(!0)},[]),A=a.useCallback(()=>{document.body.classList.remove("resta--hidden-scroll"),$(!1),S.fire(S.ORDER_AFTER_ACTION)},[S]),K=a.useCallback(s=>{if(s){const[g,f]=s;C.some(({label:_,value:U})=>{const Q=U[0].valueOf()===g.valueOf()&&U[1].valueOf()===f.valueOf();return Q&&P(_),Q})||P(""),n(s)}},[C]),F=a.useCallback(j.debounce(s=>{i(s)},300),[]),de=a.useCallback(j.debounce(s=>{u(s)},500),[]),ue=a.useCallback(j.debounce(s=>{r(s)}),[]),he=a.useCallback(j.debounce(s=>{o(s)}),[]),ge=a.useCallback(()=>{H(s=>!s)},[]),me=a.useCallback(()=>{z(s=>!s)},[]),Se=a.useCallback(s=>{w((s-1)*Z)},[]),Ce=a.useCallback((s,{from:g})=>g?Math.abs(s.diff(g,"day"))>31:!1,[]),pe=a.useCallback(()=>{n([]),i([]),u(0),r(0),o(0)},[]),q=a.useRef({}),fe=a.useCallback(s=>(q.current={},s.filter(({total:g,createdAt:f})=>{const v=W.tz(f).format(ee),_=q.current[v]=q.current[v]??{ordersSum:0,total:0};return _.total+=g,++_.ordersSum,!(c&&c&&g<c)}).filter(({createdAt:g})=>{if(h||t){const f=W.tz(g).format(ee),v=q.current[f];if(v&&(h&&v.total<h||t&&v.ordersSum<t))return!1}return!0})),[c,h,t]),be=a.useMemo(()=>{var s;return(s=e==null?void 0:e.map)==null?void 0:s.call(e,g=>g.valueOf())},[e]),{periodsOrder:L,orderListElement:ve,anchorElement:$e,summaryElement:we,totalDays:ye,callOrderAPI:Ie}=Le({datetime:e!=null&&e.length?be:"today",searchData:l,dateOrder:N,searchUI:!1,reverse:!1,offset:y,handleRecords:fe});a.useEffect(()=>{const s=S.on(S.KEYBOARD_ON_ACTION,g=>{const{action:f}=g.detail;f==="edit"&&R()});return()=>s()},[S,R]),a.useEffect(()=>{setTimeout(()=>{window.scroll({top:0,left:0,behavior:"smooth"})},200)},[y]),a.useEffect(()=>()=>{window.scroll({top:0,left:0,behavior:"smooth"})},[]);const G=L.length;return b(te,{children:[d(nn,{cls:_e,children:b(ne,{size:60,children:[d(B,{css:je,type:"text",icon:d(cn,{}),onClick:T,children:"訂單搜尋"}),!!G&&b("h2",{children:[G===1?L[0]:[L[0],L.at(-1)??""].join(" ~ "),D&&` (${D})`]})]})}),b(I,{css:Ke,gap:"middle",vertical:!0,children:[d(ie,{css:ae,rootClassName:"resta-orderlist-search-drawer",title:d(te,{children:d(B,{icon:d(Fe,{}),type:"text",onClick:pe,children:"重設"})}),getContainer:!1,placement:"left",open:m,mask:!0,onClose:M,children:b(I,{vertical:!0,gap:"large",children:[b(I,{vertical:!0,gap:"large",children:[d("h2",{children:"日期"}),d(fn,{showNow:!0,presets:C,showTime:O,format:We,placeholder:["開始日期","結束日期"],size:"large",value:e,disabledDate:Ce,onChange:K,renderExtraFooter:()=>d(B,{css:Be,type:"text",onClick:ge,children:O?"關閉時間":"指定時間"})})]}),b(I,{vertical:!0,gap:"large",children:[d("h2",{children:"關鍵字"}),d(Ve,{placeholder:"找什麼呢?",mode:"tags",size:"large",style:{width:"100%"},allowClear:!0,onKeyUp:s=>{s.preventDefault(),s.stopPropagation()},options:Xe,disabled:E,value:l,onChange:F})]}),b(I,{vertical:!0,gap:"large",children:[d("h2",{children:"日期排序"}),d(oe,{checkedChildren:"反序",unCheckedChildren:"正序",defaultChecked:!0,onChange:me})]}),b(I,{vertical:!0,gap:"large",children:[d("h2",{children:"單筆金額大於"}),d(X,{size:"large",prefix:"$",style:{width:"60%"},formatter:V,disabled:E,value:c,onChange:de})]}),b(I,{vertical:!0,gap:"large",children:[d("h2",{children:"當日營業額大於"}),d(X,{size:"large",prefix:"$",style:{width:"60%"},formatter:V,disabled:E,value:h,onChange:ue})]}),b(I,{vertical:!0,gap:"large",children:[d("h2",{children:"當日訂單數量大於"}),d(X,{size:"large",style:{width:"60%"},formatter:V,disabled:E,value:t,onChange:he})]})]})}),d(ie,{css:[ae,Ge],title:b(ne,{children:[d(Ue,{}),d("label",{children:"編輯訂單"})]}),placement:"right",open:k,mask:!0,onClose:A,width:820,forceRender:!0,children:d(Qe,{drawerMode:!0,callOrderAPI:Ie,submitCallback:A})}),b("div",{css:[Ye,(m||k)&&Je],children:[$e,d("div",{css:Ze,children:we}),d(I,{wrap:!0,children:ve}),d(an,{hideOnSinglePage:!0,total:ye,defaultPageSize:Z,onChange:Se})]}),d(en.BackTop,{visibilityHeight:100})]})]})},In=bn;export{bn as Component,In as OrderList,In as default};

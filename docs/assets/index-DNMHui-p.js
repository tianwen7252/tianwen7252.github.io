import{r as a,I as Ie,_ as ie,a as ke,u as re,b as Oe,c as le,d as Q,K as Y,g as De,m as Ee,e as x,f as Me,h as xe,T as Te,C as ze,D as Pe,i as Re,W as He,R as Ne,A as Ae,j as W,l as j,O as J,k as Z,n as qe,o as b,p as d,q as Le,S as ee,B,s as _e,F as I,t as je,v as ne,w as ae,x as Ke,y as Fe,z as We,E as Be,G as Ve,H as V,J as te,L as Xe,M as Ge,N as Ue,P as Qe,Q as Ye,U as Je,V as Ze}from"./index-C7g9fXbX.js";import{S as en}from"./StickyHeader-DXepzz04.js";import{P as nn}from"./Pagination-Bk3bcopu.js";import{D as an}from"./index-DI-l_1CR.js";var tn={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M688 312v-48c0-4.4-3.6-8-8-8H296c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h384c4.4 0 8-3.6 8-8zm-392 88c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h184c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8H296zm144 452H208V148h560v344c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8V108c0-17.7-14.3-32-32-32H168c-17.7 0-32 14.3-32 32v784c0 17.7 14.3 32 32 32h272c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm445.7 51.5l-93.3-93.3C814.7 780.7 828 743.9 828 704c0-97.2-78.8-176-176-176s-176 78.8-176 176 78.8 176 176 176c35.8 0 69-10.7 96.8-29l94.7 94.7c1.6 1.6 3.6 2.3 5.6 2.3s4.1-.8 5.6-2.3l31-31a7.9 7.9 0 000-11.2zM652 816c-61.9 0-112-50.1-112-112s50.1-112 112-112 112 50.1 112 112-50.1 112-112 112z"}}]},name:"file-search",theme:"outlined"},rn=function(n,l){return a.createElement(Ie,ie({},n,{ref:l,icon:tn}))},ln=a.forwardRef(rn),cn=["prefixCls","className","checked","defaultChecked","disabled","loadingIcon","checkedChildren","unCheckedChildren","onClick","onChange","onKeyDown"],ce=a.forwardRef(function(e,n){var l,i=e.prefixCls,c=i===void 0?"rc-switch":i,u=e.className,h=e.checked,r=e.defaultChecked,t=e.disabled,o=e.loadingIcon,m=e.checkedChildren,C=e.unCheckedChildren,k=e.onClick,$=e.onChange,O=e.onKeyDown,R=ke(e,cn),H=re(!1,{value:h,defaultValue:r}),z=Oe(H,2),y=z[0],w=z[1];function D(p,T){var M=y;return t||(M=p,w(M),$==null||$(M,T)),M}function P(p){p.which===Y.LEFT?D(!1,p):p.which===Y.RIGHT&&D(!0,p),O==null||O(p)}function S(p){var T=D(!y,p);k==null||k(T,p)}var E=le(c,u,(l={},Q(l,"".concat(c,"-checked"),y),Q(l,"".concat(c,"-disabled"),t),l));return a.createElement("button",ie({},R,{type:"button",role:"switch","aria-checked":y,disabled:t,className:E,ref:n,onKeyDown:P,onClick:S}),o,a.createElement("span",{className:"".concat(c,"-inner")},a.createElement("span",{className:"".concat(c,"-inner-checked")},m),a.createElement("span",{className:"".concat(c,"-inner-unchecked")},C)))});ce.displayName="Switch";const sn=e=>{const{componentCls:n,trackHeightSM:l,trackPadding:i,trackMinWidthSM:c,innerMinMarginSM:u,innerMaxMarginSM:h,handleSizeSM:r,calc:t}=e,o=`${n}-inner`,m=x(t(r).add(t(i).mul(2)).equal()),C=x(t(h).mul(2).equal());return{[n]:{[`&${n}-small`]:{minWidth:c,height:l,lineHeight:x(l),[`${n}-inner`]:{paddingInlineStart:h,paddingInlineEnd:u,[`${o}-checked, ${o}-unchecked`]:{minHeight:l},[`${o}-checked`]:{marginInlineStart:`calc(-100% + ${m} - ${C})`,marginInlineEnd:`calc(100% - ${m} + ${C})`},[`${o}-unchecked`]:{marginTop:t(l).mul(-1).equal(),marginInlineStart:0,marginInlineEnd:0}},[`${n}-handle`]:{width:r,height:r},[`${n}-loading-icon`]:{top:t(t(r).sub(e.switchLoadingIconSize)).div(2).equal(),fontSize:e.switchLoadingIconSize},[`&${n}-checked`]:{[`${n}-inner`]:{paddingInlineStart:u,paddingInlineEnd:h,[`${o}-checked`]:{marginInlineStart:0,marginInlineEnd:0},[`${o}-unchecked`]:{marginInlineStart:`calc(100% - ${m} + ${C})`,marginInlineEnd:`calc(-100% + ${m} - ${C})`}},[`${n}-handle`]:{insetInlineStart:`calc(100% - ${x(t(r).add(i).equal())})`}},[`&:not(${n}-disabled):active`]:{[`&:not(${n}-checked) ${o}`]:{[`${o}-unchecked`]:{marginInlineStart:t(e.marginXXS).div(2).equal(),marginInlineEnd:t(e.marginXXS).mul(-1).div(2).equal()}},[`&${n}-checked ${o}`]:{[`${o}-checked`]:{marginInlineStart:t(e.marginXXS).mul(-1).div(2).equal(),marginInlineEnd:t(e.marginXXS).div(2).equal()}}}}}}},on=e=>{const{componentCls:n,handleSize:l,calc:i}=e;return{[n]:{[`${n}-loading-icon${e.iconCls}`]:{position:"relative",top:i(i(l).sub(e.fontSize)).div(2).equal(),color:e.switchLoadingIconColor,verticalAlign:"top"},[`&${n}-checked ${n}-loading-icon`]:{color:e.switchColor}}}},dn=e=>{const{componentCls:n,trackPadding:l,handleBg:i,handleShadow:c,handleSize:u,calc:h}=e,r=`${n}-handle`;return{[n]:{[r]:{position:"absolute",top:l,insetInlineStart:l,width:u,height:u,transition:`all ${e.switchDuration} ease-in-out`,"&::before":{position:"absolute",top:0,insetInlineEnd:0,bottom:0,insetInlineStart:0,backgroundColor:i,borderRadius:h(u).div(2).equal(),boxShadow:c,transition:`all ${e.switchDuration} ease-in-out`,content:'""'}},[`&${n}-checked ${r}`]:{insetInlineStart:`calc(100% - ${x(h(u).add(l).equal())})`},[`&:not(${n}-disabled):active`]:{[`${r}::before`]:{insetInlineEnd:e.switchHandleActiveInset,insetInlineStart:0},[`&${n}-checked ${r}::before`]:{insetInlineEnd:0,insetInlineStart:e.switchHandleActiveInset}}}}},un=e=>{const{componentCls:n,trackHeight:l,trackPadding:i,innerMinMargin:c,innerMaxMargin:u,handleSize:h,calc:r}=e,t=`${n}-inner`,o=x(r(h).add(r(i).mul(2)).equal()),m=x(r(u).mul(2).equal());return{[n]:{[t]:{display:"block",overflow:"hidden",borderRadius:100,height:"100%",paddingInlineStart:u,paddingInlineEnd:c,transition:`padding-inline-start ${e.switchDuration} ease-in-out, padding-inline-end ${e.switchDuration} ease-in-out`,[`${t}-checked, ${t}-unchecked`]:{display:"block",color:e.colorTextLightSolid,fontSize:e.fontSizeSM,transition:`margin-inline-start ${e.switchDuration} ease-in-out, margin-inline-end ${e.switchDuration} ease-in-out`,pointerEvents:"none",minHeight:l},[`${t}-checked`]:{marginInlineStart:`calc(-100% + ${o} - ${m})`,marginInlineEnd:`calc(100% - ${o} + ${m})`},[`${t}-unchecked`]:{marginTop:r(l).mul(-1).equal(),marginInlineStart:0,marginInlineEnd:0}},[`&${n}-checked ${t}`]:{paddingInlineStart:c,paddingInlineEnd:u,[`${t}-checked`]:{marginInlineStart:0,marginInlineEnd:0},[`${t}-unchecked`]:{marginInlineStart:`calc(100% - ${o} + ${m})`,marginInlineEnd:`calc(-100% + ${o} - ${m})`}},[`&:not(${n}-disabled):active`]:{[`&:not(${n}-checked) ${t}`]:{[`${t}-unchecked`]:{marginInlineStart:r(i).mul(2).equal(),marginInlineEnd:r(i).mul(-1).mul(2).equal()}},[`&${n}-checked ${t}`]:{[`${t}-checked`]:{marginInlineStart:r(i).mul(-1).mul(2).equal(),marginInlineEnd:r(i).mul(2).equal()}}}}}},hn=e=>{const{componentCls:n,trackHeight:l,trackMinWidth:i}=e;return{[n]:Object.assign(Object.assign(Object.assign(Object.assign({},Me(e)),{position:"relative",display:"inline-block",boxSizing:"border-box",minWidth:i,height:l,lineHeight:x(l),verticalAlign:"middle",background:e.colorTextQuaternary,border:"0",borderRadius:100,cursor:"pointer",transition:`all ${e.motionDurationMid}`,userSelect:"none",[`&:hover:not(${n}-disabled)`]:{background:e.colorTextTertiary}}),xe(e)),{[`&${n}-checked`]:{background:e.switchColor,[`&:hover:not(${n}-disabled)`]:{background:e.colorPrimaryHover}},[`&${n}-loading, &${n}-disabled`]:{cursor:"not-allowed",opacity:e.switchDisabledOpacity,"*":{boxShadow:"none",cursor:"not-allowed"}},[`&${n}-rtl`]:{direction:"rtl"}})}},gn=e=>{const{fontSize:n,lineHeight:l,controlHeight:i,colorWhite:c}=e,u=n*l,h=i/2,r=2,t=u-r*2,o=h-r*2;return{trackHeight:u,trackHeightSM:h,trackMinWidth:t*2+r*4,trackMinWidthSM:o*2+r*2,trackPadding:r,handleBg:c,handleSize:t,handleSizeSM:o,handleShadow:`0 2px 4px 0 ${new Te("#00230b").setAlpha(.2).toRgbString()}`,innerMinMargin:t/2,innerMaxMargin:t+r+r*2,innerMinMarginSM:o/2,innerMaxMarginSM:o+r+r*2}},mn=De("Switch",e=>{const n=Ee(e,{switchDuration:e.motionDurationMid,switchColor:e.colorPrimary,switchDisabledOpacity:e.opacityLoading,switchLoadingIconSize:e.calc(e.fontSizeIcon).mul(.75).equal(),switchLoadingIconColor:`rgba(0, 0, 0, ${e.opacityLoading})`,switchHandleActiveInset:"-30%"});return[hn(n),un(n),dn(n),on(n),sn(n)]},gn);var Sn=function(e,n){var l={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&n.indexOf(i)<0&&(l[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,i=Object.getOwnPropertySymbols(e);c<i.length;c++)n.indexOf(i[c])<0&&Object.prototype.propertyIsEnumerable.call(e,i[c])&&(l[i[c]]=e[i[c]]);return l};const pn=a.forwardRef((e,n)=>{const{prefixCls:l,size:i,disabled:c,loading:u,className:h,rootClassName:r,style:t,checked:o,value:m,defaultChecked:C,defaultValue:k,onChange:$}=e,O=Sn(e,["prefixCls","size","disabled","loading","className","rootClassName","style","checked","value","defaultChecked","defaultValue","onChange"]),[R,H]=re(!1,{value:o??m,defaultValue:C??k}),{getPrefixCls:z,direction:y,switch:w}=a.useContext(ze),D=a.useContext(Pe),P=(c??D)||u,S=z("switch",l),E=a.createElement("div",{className:`${S}-handle`},u&&a.createElement(Ne,{className:`${S}-loading-icon`})),[p,T,M]=mn(S),N=Re(i),A=le(w==null?void 0:w.className,{[`${S}-small`]:N==="small",[`${S}-loading`]:u,[`${S}-rtl`]:y==="rtl"},h,r,T,M),K=Object.assign(Object.assign({},w==null?void 0:w.style),t),F=function(){H(arguments.length<=0?void 0:arguments[0]),$==null||$.apply(void 0,arguments)};return p(a.createElement(He,{component:"Switch"},a.createElement(ce,Object.assign({},O,{checked:R,onChange:F,prefixCls:S,className:A,style:K,disabled:P,ref:n,loadingIcon:E}))))}),se=pn;se.__ANT_SWITCH=!0;const{RangePicker:Cn}=an,fn=()=>{const[e,n]=a.useState(),[l,i]=a.useState([]),[c,u]=a.useState(0),[h,r]=a.useState(0),[t,o]=a.useState(0),[m,C]=a.useState(!1),[k,$]=a.useState(!1),[O,R]=a.useState(!1),[H,z]=a.useState(!0),[y,w]=a.useState(0),[D,P]=a.useState(""),{appEvent:S}=a.useContext(Ae),E=!(e!=null&&e.length),p=a.useMemo(()=>{const s=W.tz(),g=s.startOf("day"),f=s.endOf("day"),v=g.add(-1,"d");return[{label:"今天",value:[g,f]},{label:"昨天",value:[v,v.endOf("day")]},{label:"2天內",value:[v,f]},{label:"7天前",value:[g.add(-7,"d"),f]},{label:"14天內",value:[g.add(-14,"d"),f]},{label:"1個月內",value:[g.add(-30,"d"),f]}]},[]),T=a.useCallback(()=>{C(!0)},[]),M=a.useCallback(()=>{C(!1)},[]),N=a.useCallback(()=>{document.body.classList.add("resta--hidden-scroll"),$(!0)},[]),A=a.useCallback(()=>{document.body.classList.remove("resta--hidden-scroll"),$(!1),S.fire(S.ORDER_AFTER_ACTION)},[S]),K=a.useCallback(s=>{if(s){const[g,f]=s;p.some(({label:_,value:G})=>{const U=G[0].valueOf()===g.valueOf()&&G[1].valueOf()===f.valueOf();return U&&P(_),U})||P(""),n(s)}},[p]),F=a.useCallback(j.debounce(s=>{i(s)},300),[]),oe=a.useCallback(j.debounce(s=>{u(s)},500),[]),de=a.useCallback(j.debounce(s=>{r(s)}),[]),ue=a.useCallback(j.debounce(s=>{o(s)}),[]),he=a.useCallback(()=>{R(s=>!s)},[]),ge=a.useCallback(()=>{z(s=>!s)},[]),me=a.useCallback(s=>{w((s-1)*J)},[]),Se=a.useCallback((s,{from:g})=>g?Math.abs(s.diff(g,"day"))>31:!1,[]),pe=a.useCallback(()=>{n([]),i([]),u(0),r(0),o(0)},[]),q=a.useRef({}),Ce=a.useCallback(s=>(q.current={},s.filter(({total:g,createdAt:f})=>{const v=W.tz(f).format(Z),_=q.current[v]=q.current[v]??{ordersSum:0,total:0};return _.total+=g,++_.ordersSum,!(c&&c&&g<c)}).filter(({createdAt:g})=>{if(h||t){const f=W.tz(g).format(Z),v=q.current[f];if(v&&(h&&v.total<h||t&&v.ordersSum<t))return!1}return!0})),[c,h,t]),fe=a.useMemo(()=>{var s;return(s=e==null?void 0:e.map)==null?void 0:s.call(e,g=>g.valueOf())},[e]),{periodsOrder:L,orderListElement:be,anchorElement:ve,summaryElement:$e,totalDays:we,callOrderAPI:ye}=qe({datetime:e!=null&&e.length?fe:"today",searchData:l,dateOrder:H,searchUI:!1,reverse:!1,offset:y,handleRecords:Ce});a.useEffect(()=>{const s=S.on(S.KEYBOARD_ON_ACTION,g=>{const{action:f}=g.detail;f==="edit"&&N()});return()=>s()},[S,N]),a.useEffect(()=>{setTimeout(()=>{window.scroll({top:0,left:0,behavior:"smooth"})},200)},[y]),a.useEffect(()=>()=>{window.scroll({top:0,left:0,behavior:"smooth"})},[]);const X=L.length;return b(ae,{children:[d(en,{cls:Le,children:b(ee,{size:60,children:[d(B,{css:_e,type:"text",icon:d(ln,{}),onClick:T,children:"訂單搜尋"}),X?b("h2",{children:[X===1?L[0]:[L[0],L.at(-1)??""].join(" ~ "),D&&` (${D})`]}):d("h2",{children:"今天"})]})}),b(I,{css:je,gap:"middle",vertical:!0,children:[d(te,{css:ne,rootClassName:"resta-orderlist-search-drawer",title:d(ae,{children:d(B,{icon:d(Ke,{}),type:"text",onClick:pe,children:"重設"})}),getContainer:!1,placement:"left",open:m,mask:!0,onClose:M,children:b(I,{vertical:!0,gap:"large",children:[b(I,{vertical:!0,gap:"large",children:[d("h2",{children:"日期"}),d(Cn,{showNow:!0,inputReadOnly:!0,presets:p,showTime:O,format:Fe,placeholder:["開始日期","結束日期"],size:"large",value:e,disabledDate:Se,onChange:K,renderExtraFooter:()=>d(B,{css:We,type:"text",onClick:he,children:O?"關閉時間":"指定時間"})})]}),b(I,{vertical:!0,gap:"large",children:[d("h2",{children:"關鍵字"}),d(Be,{placeholder:"找什麼呢?",mode:"tags",size:"large",style:{width:"100%"},allowClear:!0,onKeyUp:s=>{s.preventDefault(),s.stopPropagation()},options:Ve,disabled:E,value:l,onChange:F})]}),b(I,{vertical:!0,gap:"large",children:[d("h2",{children:"日期排序"}),d(se,{checkedChildren:"反序",unCheckedChildren:"正序",defaultChecked:!0,onChange:ge})]}),b(I,{vertical:!0,gap:"large",children:[d("h2",{children:"單筆金額大於"}),d(V,{size:"large",type:"number",prefix:"$",style:{width:"60%"},disabled:E,value:c,onChange:oe})]}),b(I,{vertical:!0,gap:"large",children:[d("h2",{children:"當日營業額大於"}),d(V,{size:"large",type:"number",prefix:"$",style:{width:"60%"},disabled:E,value:h,onChange:de})]}),b(I,{vertical:!0,gap:"large",children:[d("h2",{children:"當日訂單數量大於"}),d(V,{size:"large",type:"number",style:{width:"60%"},disabled:E,value:t,onChange:ue})]})]})}),d(te,{css:[ne,Xe],title:b(ee,{children:[d(Ge,{}),d("label",{children:"編輯訂單"})]}),placement:"right",open:k,mask:!0,onClose:A,width:820,forceRender:!0,children:d(Ue,{drawerMode:!0,callOrderAPI:ye,submitCallback:A})}),b("div",{css:[Qe,(m||k)&&Ye],children:[ve,d("div",{css:Je,children:$e}),d(I,{wrap:!0,children:be}),d(nn,{hideOnSinglePage:!0,total:we,defaultPageSize:J,onChange:me})]}),d(Ze.BackTop,{visibilityHeight:100})]})]})},yn=fn;export{fn as Component,yn as OrderList,yn as default};
